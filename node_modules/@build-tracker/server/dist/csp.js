"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
var getNonce = function (_req, res) { return "'nonce-" + res.locals.nonce + "'"; };
var getCSP = function (allowUnsafeEval) {
    if (allowUnsafeEval === void 0) { allowUnsafeEval = false; }
    return ({
        blockAllMixedContent: true,
        connectSrc: ["'self'"],
        childSrc: ["'self'"],
        defaultSrc: ["'self'"],
        fontSrc: ["'self'"],
        formAction: ["'self'"],
        frameAncestors: ["'none'"],
        frameSrc: ["'none'"],
        imgSrc: ["'self'"],
        manifestSrc: ["'self'"],
        mediaSrc: ["'self'"],
        objectSrc: ["'self'"],
        scriptSrc: [allowUnsafeEval && "'unsafe-eval'", "'strict-dynamic'", getNonce].filter(Boolean),
        styleSrc: ["'self'", "'unsafe-inline'"],
        upgradeInsecureRequests: false,
        workerSrc: ["'self'"]
    });
};
exports.default = getCSP;
//# sourceMappingURL=csp.js.map